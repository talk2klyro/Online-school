<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MADARASATUN NISA'I — Export</title>
  <style>
/* same base CSS */
*{box-sizing:border-box}body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;margin:0;background:#f6f7fb;color:#111}
.container{max-width:1100px;margin:0 auto;padding:16px}
.brand{display:flex;justify-content:space-between;align-items:center;padding:16px;border-bottom:1px solid #e5e7eb;background:white;position:sticky;top:0;z-index:10}
.brand h1{margin:0;font-size:20px;letter-spacing:.5px}
.brand .motto{margin:4px 0 0 0;font-size:12px;opacity:.8}
.brand-right p{margin:2px 0;font-size:12px}
.nav{display:flex;gap:8px;flex-wrap:wrap;padding:12px 16px;background:#fff;border-bottom:1px solid #e5e7eb}
.nav a{padding:8px 12px;border-radius:12px;text-decoration:none;border:1px solid #e5e7eb;background:#fafafa}
.nav a:hover{background:#f0f0f0}
.card{background:#fff;border:1px solid #e5e7eb;border-radius:16px;padding:16px;margin-top:16px;box-shadow:0 1px 2px rgba(0,0,0,.04)}
.input, select{width:100%;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff}
.btn{padding:10px 14px;border:none;border-radius:12px;cursor:pointer}
.btn.primary{background:#111;color:#fff}
.btn.ghost{background:#fff;border:1px solid #e5e7eb}
.table{width:100%;border-collapse:collapse}
.table th,.table td{padding:10px;border-bottom:1px solid #eee;text-align:left;font-size:14px}
.table th{background:#fafafa;position:sticky;top:0}
.badge{display:inline-block;padding:4px 8px;border-radius:999px;background:#efefef;font-size:12px}
.row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
@media (max-width:720px){.row{grid-template-columns:1fr} .brand{flex-direction:column;align-items:flex-start;gap:6px}}
footer{padding:24px 16px;text-align:center;color:#555}
  </style>
</head>
<body>
  <header class='brand'>
    <div class='brand-left'>
      <h1>MADARASATUN NISA'I</h1>
      <p class='motto'>ILIMI HASKEN RAYUWA</p>
    </div>
    <div class='brand-right'>
      <p>Email: <a href='mailto:ibrahimsadau6644@gmail.com'>ibrahimsadau6644@gmail.com</a></p>
      <p>GSM: 07066144944, 08035458742</p>
    </div>
  </header>
  <nav class='nav'>
    <a href='index.html'>Dashboard</a>
    <a href='add-student.html'>Add Student</a>
    <a href='attendance.html'>Attendance Register</a>
    <a href='export.html'>Export</a>
  </nav>

  <main class="container">
    <section class="card">
      <h2>Export Attendance</h2>
      <p>Download the current data as <b>attendance.csv</b> generated from Notion.</p>
      <button class="btn primary" id="downloadBtn">Download CSV</button>
      <p id="msg"></p>
    </section>
  </main>
  <footer>© 2025 MADARASATUN NISA'I</footer>

  <script>
    document.getElementById('downloadBtn').addEventListener('click', async () => {
      try {
        const res = await fetch('/api/export');
        if (!res.ok) throw new Error('Export failed');
        const blob = await res.blob();
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url; a.download = 'attendance.csv';
        document.body.appendChild(a); a.click(); a.remove();
        URL.revokeObjectURL(url);
        document.getElementById('msg').textContent = 'Download started.';
      } catch (e) {
        document.getElementById('msg').textContent = '⚠️ ' + e.message;
      }
    });
  </script>
</body>
</html>
